# Databricks Asset Bundle Configuration for LangGraph Tutorial
# This file defines how to deploy the tutorial to your Databricks workspace

bundle:
  name: langraph-tutorial

# Variables that can be customized per environment
variables:
  # Unity Catalog configuration
  catalog:
    description: "Unity Catalog name for AI functions and data"
    default: "langtutorial_vik"
  
  schema:
    description: "Schema name within the catalog"
    default: "agents"
  
  # Compute configuration
  cluster_id:
    description: "Existing cluster ID to attach notebooks to"
    default: "0304-162117-qgsi1x04"  # From MY_ENVIRONMENT.md
  
  warehouse_id:
    description: "SQL Warehouse ID for running queries"
    default: "148ccb90800933a1"  # From MY_ENVIRONMENT.md
  
  # Vector Search configuration
  vector_search_endpoint:
    description: "Vector Search endpoint name (shared, create if not exists)"
    default: "one-env-shared-endpoint-2"
  
  vector_search_index:
    description: "Vector Search index name"
    default: "${var.catalog}.${var.schema}.knowledge_base_index"

# Workspace configuration
workspace:
  host: https://adb-984752964297111.11.azuredatabricks.net  # From MY_ENVIRONMENT.md
  root_path: ~/.bundle/${bundle.name}/${bundle.target}

# Include configuration (only YAML/JSON files)
include:
  - "*.yml"

# Sync configuration (for all other files)
sync:
  include:
    - "notebooks/**"
    - "tutorial/**"
    - "docs/**"
    - "knowledge_base/**"
    - "requirements.txt"
    - "README.md"
    - "BEGINNER_TUTORIAL.md"
    - "SETUP_INSTRUCTIONS.md"

# Deployment targets
targets:
  # Development environment
  dev:
    mode: development
    default: true
    workspace:
      root_path: ~/.bundle/${bundle.name}/dev
    
    # Development-specific variables
    variables:
      catalog: "langraph_tutorial_dev"
      schema: "agents_dev"
  
  # Staging environment
  staging:
    mode: production
    workspace:
      root_path: ~/.bundle/${bundle.name}/staging
      # host: https://your-staging-workspace.cloud.databricks.com  # Optional: different workspace
    
    variables:
      catalog: "langraph_tutorial_staging"
      schema: "agents"
  
  # Production environment
  prod:
    mode: production
    workspace:
      root_path: ~/.bundle/${bundle.name}/prod
      # host: https://your-prod-workspace.cloud.databricks.com  # Optional: different workspace
    
    variables:
      catalog: "langraph_tutorial"
      schema: "agents"

# Resources to deploy (jobs, apps, etc - not needed for tutorial)

# Optional: Jobs (for automated running)
# Uncomment to enable scheduled tutorial runs or CI/CD
#  jobs:
#    tutorial_validation:
#      name: "Validate LangGraph Tutorial"
#      
#      tasks:
#        - task_key: run_tutorial
#          notebook_task:
#            notebook_path: ${workspace.root_path}/tutorial/23_langraph_agent_learning.py
#          
#          existing_cluster_id: ${var.cluster_id}
#      
#      # Optional: Schedule to run daily
#      schedule:
#        quartz_cron_expression: "0 0 9 * * ?"  # 9 AM daily
#        timezone_id: "America/Los_Angeles"
#      
#      # Email notifications
#      email_notifications:
#        on_failure:
#          - your-email@company.com

# Optional: Experiments (for MLflow tracking)
#  experiments:
#    langraph_tutorial:
#      name: /Users/${workspace.current_user.userName}/langraph-tutorial-experiments

# Permissions
# Uncomment to set specific permissions
#permissions:
#  - level: CAN_MANAGE
#    user_name: your-email@company.com
#  
#  - level: CAN_VIEW
#    group_name: data-scientists

